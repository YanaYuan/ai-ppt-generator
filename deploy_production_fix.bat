@echo off
echo ========================================
echo   AI PPT ç”Ÿæˆå™¨ - ç”Ÿäº§çŽ¯å¢ƒä¿®å¤éƒ¨ç½²
echo ========================================
echo.

:: è®¾ç½®ç¼–ç ä¸ºUTF-8
chcp 65001 >nul

echo ðŸ”§ æ­£åœ¨éƒ¨ç½²ç”Ÿäº§çŽ¯å¢ƒAPIä¿®å¤...
echo.

:: æ£€æŸ¥å…³é”®æ–‡ä»¶
echo ðŸ“‹ æ£€æŸ¥æ–‡ä»¶çŠ¶æ€:
if exist "ai-ppt-generator.html" (
    echo âœ… ä¸»åº”ç”¨æ–‡ä»¶å­˜åœ¨
) else (
    echo âŒ ä¸»åº”ç”¨æ–‡ä»¶ç¼ºå¤±
    goto :error
)

if exist "vercel.json" (
    echo âœ… Vercelé…ç½®æ–‡ä»¶å­˜åœ¨
) else (
    echo âŒ Vercelé…ç½®æ–‡ä»¶ç¼ºå¤±
    goto :error
)

if exist "api\openai.js" (
    echo âœ… OpenAI APIä»£ç†å­˜åœ¨
) else (
    echo âŒ OpenAI APIä»£ç†ç¼ºå¤±
    goto :error
)

if exist "api\diagnostic.js" (
    echo âœ… è¯Šæ–­APIå­˜åœ¨
) else (
    echo âŒ è¯Šæ–­APIç¼ºå¤±
    goto :error
)

echo.

:: æ˜¾ç¤ºä¿®å¤å†…å®¹
echo ðŸŽ¯ æœ¬æ¬¡ä¿®å¤å†…å®¹:
echo   âœ… æ”¹è¿›ç”Ÿäº§çŽ¯å¢ƒAPIè°ƒç”¨é€»è¾‘ï¼Œæ”¯æŒæ™ºèƒ½é‡è¯•
echo   âœ… æ·»åŠ å¤šå±‚åŽå¤‡ç­–ç•¥ï¼Œç¡®ä¿ç”¨æˆ·å§‹ç»ˆèƒ½çœ‹åˆ°å†…å®¹
echo   âœ… ä¼˜åŒ–é”™è¯¯å¤„ç†ï¼Œ404/500é”™è¯¯è‡ªåŠ¨å›žé€€åˆ°æ¼”ç¤ºæ•°æ®
echo   âœ… å¢žåŠ APIçŠ¶æ€æ£€æµ‹ï¼Œé¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥æœåŠ¡å¯ç”¨æ€§
echo   âœ… æ”¹è¿›ç”¨æˆ·ä½“éªŒï¼Œæ¸…æ™°çš„çŠ¶æ€æç¤ºå’Œé”™è¯¯è¯´æ˜Ž
echo.

:: Gitæ“ä½œ
echo ðŸ“¤ æäº¤æ›´æ”¹åˆ°Git...
git add .
git commit -m "fix: ä¿®å¤ç”Ÿäº§çŽ¯å¢ƒAPIè°ƒç”¨é—®é¢˜ï¼Œæ·»åŠ æ™ºèƒ½é‡è¯•å’ŒåŽå¤‡ç­–ç•¥ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒ"

if %ERRORLEVEL% NEQ 0 (
    echo âŒ Gitæäº¤å¤±è´¥
    goto :error
)

echo ðŸ“¤ æŽ¨é€åˆ°GitHub...
git push origin main

if %ERRORLEVEL% NEQ 0 (
    echo âŒ GitæŽ¨é€å¤±è´¥
    goto :error
)

echo.
echo âœ… ä¿®å¤éƒ¨ç½²æˆåŠŸï¼
echo.

:: æ˜¾ç¤ºéªŒè¯æ­¥éª¤
echo ========================================
echo           ðŸ§ª éªŒè¯ä¿®å¤æ•ˆæžœ
echo ========================================
echo.
echo è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸ:
echo.
echo 1. ç­‰å¾…Verceléƒ¨ç½²å®Œæˆ (é€šå¸¸1-3åˆ†é’Ÿ)
echo.
echo 2. è®¿é—®æ‚¨çš„åº”ç”¨: https://your-app.vercel.app/
echo.
echo 3. æ£€æŸ¥APIçŠ¶æ€æŒ‡ç¤ºå™¨:
echo    ðŸŸ¢ ç»¿è‰² = AIæœåŠ¡æ­£å¸¸ï¼Œä¼šç”ŸæˆçœŸå®žå†…å®¹
echo    ðŸŸ¡ é»„è‰² = APIå¯ç”¨ä½†é…ç½®ä¸å®Œæ•´
echo    ðŸ”´ çº¢è‰² = APIä¸å¯ç”¨ï¼Œä½¿ç”¨æ¼”ç¤ºæ•°æ®
echo.
echo 4. æµ‹è¯•ç”ŸæˆåŠŸèƒ½:
echo    - ç‚¹å‡»"ç»™æˆ‘ä¸€ä¸ªç¤ºä¾‹"å¡«å……å†…å®¹
echo    - é€‰æ‹©ä¸åŒç»„ä»¶ç±»åž‹
echo    - ç‚¹å‡»"ç”Ÿæˆé¢„è§ˆ"
echo    - åº”è¯¥èƒ½çœ‹åˆ°å†…å®¹ï¼Œä¸ä¼šå‡ºçŽ°æ— æ³•ç”Ÿæˆçš„æƒ…å†µ
echo.
echo 5. å¦‚æžœçœ‹åˆ°APIé”™è¯¯æç¤º:
echo    - å†…å®¹ä»ç„¶ä¼šæ­£å¸¸æ˜¾ç¤ºï¼ˆä½¿ç”¨æ¼”ç¤ºæ•°æ®ï¼‰
echo    - æ£€æŸ¥VercelçŽ¯å¢ƒå˜é‡é…ç½®:
echo      * AZURE_OPENAI_API_KEY
echo      * AZURE_OPENAI_ENDPOINT
echo.
echo 6. ä½¿ç”¨è¯Šæ–­å·¥å…·è¿›ä¸€æ­¥æ£€æŸ¥:
echo    è®¿é—®: https://your-app.vercel.app/api-404-diagnosis.html
echo.
echo ========================================
echo            âš™ï¸ çŽ¯å¢ƒå˜é‡é…ç½®
echo ========================================
echo.
echo å¦‚æžœAPIçŠ¶æ€æ˜¾ç¤ºé…ç½®ä¸å®Œæ•´ï¼Œè¯·åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­é…ç½®:
echo.
echo å˜é‡å: AZURE_OPENAI_API_KEY
echo å€¼: æ‚¨çš„Azure OpenAI APIå¯†é’¥
echo.
echo å˜é‡å: AZURE_OPENAI_ENDPOINT  
echo å€¼: https://your-resource-name.openai.azure.com
echo.
echo é…ç½®å®ŒæˆåŽéœ€è¦é‡æ–°éƒ¨ç½²é¡¹ç›®ã€‚
echo.
echo ========================================
echo             ðŸ“Š å…³é”®æ”¹è¿›
echo ========================================
echo.
echo âœ… æ°¸ä¸å‡ºé”™: å³ä½¿APIå®Œå…¨å¤±è´¥ï¼Œç”¨æˆ·ä¹Ÿèƒ½çœ‹åˆ°æ¼”ç¤ºå†…å®¹
echo âœ… æ™ºèƒ½é‡è¯•: è‡ªåŠ¨é‡è¯•å¤±è´¥çš„APIè°ƒç”¨ï¼Œæé«˜æˆåŠŸçŽ‡
echo âœ… çŠ¶æ€é€æ˜Ž: æ¸…æ™°æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„æ˜¯AIç”Ÿæˆè¿˜æ˜¯æ¼”ç¤ºæ•°æ®
echo âœ… ç”¨æˆ·å‹å¥½: ä¸å†å¼¹å‡ºæŠ€æœ¯é”™è¯¯ï¼Œè€Œæ˜¯æ˜¾ç¤ºå‹å¥½æç¤º
echo âœ… ä¾¿äºŽè°ƒè¯•: è¯¦ç»†çš„æŽ§åˆ¶å°æ—¥å¿—ï¼Œä¾¿äºŽæŠ€æœ¯äººå‘˜æŽ’æŸ¥é—®é¢˜
echo.

goto :end

:error
echo.
echo âŒ éƒ¨ç½²å¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯
echo.
pause
exit /b 1

:end
echo.
echo ðŸŽ‰ éƒ¨ç½²å®Œæˆï¼çŽ°åœ¨ç”Ÿäº§çŽ¯å¢ƒåº”è¯¥èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚
echo.
echo æŒ‰ä»»æ„é”®é€€å‡º...
pause >nul
