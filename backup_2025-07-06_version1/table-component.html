<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>äº§å“åŠŸèƒ½å¯¹æ¯”è¡¨æ ¼</title>
    <link href="https://picture-search.tiangong.cn/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="slide-container bg-gradient-to-br from-gray-900 to-blue-900 text-white relative">
        <!-- Background Pattern -->
        <div class="absolute inset-0 bg-tech-pattern opacity-10"></div>
        
        <!-- Abstract Tech Elements -->
        <div class="absolute top-20 right-40 w-64 h-64 rounded-full border border-blue-400 opacity-10"></div>
        <div class="absolute bottom-20 left-40 w-48 h-48 rounded-full border border-blue-400 opacity-10"></div>
        
        <!-- Main Content -->
        <main class="px-16 pt-12 pb-8">
            <!-- Title Section -->
            <div class="w-full mb-6">
                <h2 class="text-2xl font-semibold text-blue-300 mb-4">
                    <i class="fas fa-table mr-2"></i><span id="main-title">äº§å“åŠŸèƒ½å¯¹æ¯”è¡¨æ ¼</span>
                </h2>
            </div>
            
            <!-- Comparison Table -->
            <div class="bg-blue-900 bg-opacity-40 rounded-lg border border-blue-800 overflow-hidden">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="bg-blue-800 bg-opacity-50">
                            <th class="py-3 px-4 text-left text-cyan-200 font-semibold">äº§å“åç§°</th>
                            <th class="py-3 px-4 text-center text-cyan-200 font-semibold">ä¸»é¢˜ç”Ÿæˆå¤§çº²</th>
                            <th class="py-3 px-4 text-center text-cyan-200 font-semibold">æ–‡æ¡£è½¬æ¢</th>
                            <th class="py-3 px-4 text-center text-cyan-200 font-semibold">AIè¾…åŠ©æ–‡æ¡ˆä¼˜åŒ–</th>
                            <th class="py-3 px-4 text-left text-cyan-200 font-semibold">ç‰¹è‰²åŠŸèƒ½</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">åšæ€AIPPT (PPTGO)</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>ä¸€å¥è¯ç”Ÿæˆ</span>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>å¤šæ ¼å¼æ”¯æŒ</span>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">æ™ºèƒ½æç‚¼æ–‡ä»¶å†…å®¹ï¼Œå…¨æµç¨‹è‡ªåŠ¨åŒ–</td>
                        </tr>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">Gamma</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-minus"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">é«˜è´¨é‡å†…å®¹ç”Ÿæˆï¼Œå‡å°‘æ‰‹åŠ¨è®¾è®¡å·¥ä½œ</td>
                        </tr>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">Canva PPT</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-minus"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>å“ç‰Œé£æ ¼</span>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">è¿è´¯å™äº‹æ€§PPTç”Ÿæˆï¼Œå“ç‰Œé£æ ¼æ–‡æ¡ˆ</td>
                        </tr>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">Tome</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>å®Œæ•´å¥—ä»¶</span>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-minus"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ã€å¤§çº²ã€å†…å®¹ã€é…å›¾</td>
                        </tr>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">SlidesAI</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>é€»è¾‘æ¡†æ¶</span>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">å¤šè¯­è¨€æ”¯æŒï¼Œé€»è¾‘æ¡†æ¶è‡ªåŠ¨æ„å»º</td>
                        </tr>
                        <tr class="border-t border-blue-800">
                            <td class="py-3 px-4 font-medium">Microsoft Copilot</td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-star mr-1"></i>
                                    <span>Officeé›†æˆ</span>
                                </div>
                            </td>
                            <td class="py-3 px-4">
                                <div class="capability-cell">
                                    <i class="fas fa-check"></i>
                                </div>
                            </td>
                            <td class="py-3 px-4 text-gray-300">ä¸Officeå¥—ä»¶æ·±åº¦é›†æˆï¼Œæ–‡æ¡£ç›´æ¥è½¬PPT</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Legend -->
            <div class="mt-4 text-sm">
                <div class="flex items-center justify-center mb-2">
                    <i class="fas fa-star text-yellow-400 mr-1"></i>
                    <span class="text-gray-300">é‡è¦ä¿¡æ¯</span>
                </div>
                <div id="important-explanation" class="text-center text-gray-400 text-xs italic">
                    <!-- åŠ¨æ€æ˜¾ç¤ºé‡è¦ä¿¡æ¯çš„è¯¦ç»†è¯´æ˜ -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // ç›‘å¬æ¥è‡ªçˆ¶é¡µé¢çš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.data.type === 'updateContent' && event.data.component === 'table-component') {
                updateContent(event.data.content);
            }
        });

        function updateContent(content) {
            // æ›´æ–°æ ‡é¢˜
            const titleElement = document.getElementById('main-title');
            if (titleElement && content.title) {
                titleElement.textContent = content.title;
            }

            // åŠ¨æ€ç”Ÿæˆå®Œæ•´è¡¨æ ¼
            const tableContainer = document.querySelector('.bg-blue-900');
            if (content.headers && content.rows && tableContainer) {
                // æ‰¾å‡ºæœ€é‡è¦çš„æ•°æ®ä½ç½®ï¼ˆ1ä¸ªï¼‰
                const importantCells = findMostImportantCells(content);
                
                // åˆ›å»ºæ–°çš„è¡¨æ ¼HTML
                let tableHTML = '<table class="w-full text-sm">';
                
                // ç”Ÿæˆè¡¨å¤´
                tableHTML += '<thead><tr class="bg-blue-800 bg-opacity-50">';
                content.headers.forEach(header => {
                    tableHTML += `<th class="py-3 px-4 text-left text-cyan-200 font-semibold">${header}</th>`;
                });
                tableHTML += '</tr></thead>';
                
                // ç”Ÿæˆè¡¨æ ¼å†…å®¹
                tableHTML += '<tbody>';
                content.rows.forEach((row, rowIndex) => {
                    tableHTML += '<tr class="border-t border-blue-800">';
                    row.forEach((cellData, cellIndex) => {
                        const tdClass = 'py-3 px-4' + (cellIndex === 0 ? ' font-medium' : '');
                        
                        // æ£€æŸ¥è¿™ä¸ªå•å…ƒæ ¼æ˜¯å¦åœ¨é‡è¦ä½ç½®åˆ—è¡¨ä¸­
                        const importantCell = importantCells.find(pos => pos.row === rowIndex && pos.col === cellIndex);
                        
                        if (importantCell) {
                            tableHTML += `<td class="${tdClass}">
                                <span class="flex items-center group relative">
                                    <i class="fas fa-star text-yellow-400 mr-2"></i>
                                    ${cellData}
                                    <div class="invisible group-hover:visible absolute left-0 top-8 bg-gradient-to-r from-gray-800 to-gray-700 text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap z-10 border border-yellow-400 shadow-lg">
                                        ${importantCell.reason}
                                        <div class="absolute -top-1 left-4 w-2 h-2 bg-gray-800 border-l border-t border-yellow-400 transform rotate-45"></div>
                                    </div>
                                </span>
                            </td>`;
                        } else {
                            tableHTML += `<td class="${tdClass}">${cellData}</td>`;
                        }
                    });
                    tableHTML += '</tr>';
                });
                tableHTML += '</tbody></table>';
                
                // æ›¿æ¢æ•´ä¸ªè¡¨æ ¼
                tableContainer.innerHTML = tableHTML;
                
                // æ›´æ–°è¡¨æ ¼ä¸‹æ–¹çš„é‡è¦ä¿¡æ¯è¯´æ˜
                updateImportantInfoExplanation(importantCells, content);
            }
        }
        
        // æ›´æ–°è¡¨æ ¼ä¸‹æ–¹çš„é‡è¦ä¿¡æ¯è¯´æ˜
        function updateImportantInfoExplanation(importantCells, content) {
            const explanationElement = document.getElementById('important-explanation');
            if (!explanationElement) return;
            
            if (importantCells.length > 0) {
                const cell = importantCells[0];
                const cellData = content.rows[cell.row][cell.col];
                const columnHeader = content.headers[cell.col];
                const rowName = content.rows[cell.row][0];
                
                // ç”Ÿæˆç®€æ´çš„è¯´æ˜æ–‡æœ¬
                let explanation = `${rowName} çš„ "${cellData}" å€¼å¾—é‡ç‚¹å…³æ³¨`;
                
                // æ ¹æ®åŸå› ç±»å‹ç”Ÿæˆä¸åŒçš„è¯´æ˜
                if (cell.reason.includes('è¯¥åˆ—æœ€é«˜å€¼')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯ "${columnHeader}" ä¸­çš„æœ€é«˜å€¼`;
                } else if (cell.reason.includes('è¯¥åˆ—æœ€ä½å€¼')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯ "${columnHeader}" ä¸­çš„æœ€ä½å€¼`;
                } else if (cell.reason.includes('æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯å…³é”®ä¸šåŠ¡æŒ‡æ ‡`;
                } else if (cell.reason.includes('ç‹¬ç‰¹åŠŸèƒ½')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯ç‹¬ç‰¹çš„åŠŸèƒ½ç‰¹è‰²`;
                } else if (cell.reason.includes('ç™¾åˆ†æ¯”æ•°æ®')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯é‡è¦çš„ç™¾åˆ†æ¯”æŒ‡æ ‡`;
                } else if (cell.reason.includes('é‡è¦é‡‘é¢')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¯é‡è¦çš„é‡‘é¢æ•°æ®`;
                } else if (cell.reason.includes('å˜åŒ–è¶‹åŠ¿')) {
                    explanation += `ï¼Œå› ä¸ºè¿™æ˜¾ç¤ºäº†æ˜æ˜¾çš„å˜åŒ–è¶‹åŠ¿`;
                } else {
                    explanation += `ï¼Œ${cell.reason.replace(/[ğŸ”¥â­ğŸ“Œ]/g, '').replace(/å…³é”®æ•°æ®ï¼š|é‡è¦ä¿¡æ¯ï¼š|å€¼å¾—å…³æ³¨ï¼š/g, '')}`;
                }
                
                explanationElement.textContent = explanation;
                explanationElement.style.display = 'block';
            } else {
                explanationElement.style.display = 'none';
            }
        }
        
        // æ‰¾å‡ºè¡¨æ ¼ä¸­æœ€é‡è¦çš„1ä¸ªæ•°æ®ä½ç½®
        function findMostImportantCells(content) {
            const importantCells = [];
            const maxImportant = 1; // åªæ ‡è®°1ä¸ªæœ€é‡è¦çš„
            
            // ä¸ºæ¯ä¸ªæ•°æ®å•å…ƒæ ¼è®¡ç®—é‡è¦æ€§å¾—åˆ†
            const cellScores = [];
            
            content.rows.forEach((row, rowIndex) => {
                row.forEach((cellData, cellIndex) => {
                    // è·³è¿‡ç¬¬ä¸€åˆ—ï¼ˆé€šå¸¸æ˜¯åç§°ï¼‰
                    if (cellIndex === 0) return;
                    
                    const result = calculateImportanceScore(cellData, cellIndex, content.headers[cellIndex], content);
                    if (result.score > 0) {
                        cellScores.push({
                            row: rowIndex,
                            col: cellIndex,
                            score: result.score,
                            reason: result.reason,
                            data: cellData
                        });
                    }
                });
            });
            
            // æŒ‰å¾—åˆ†æ’åºï¼Œå–å‰1-3ä¸ª
            cellScores.sort((a, b) => b.score - a.score);
            const topCells = cellScores.slice(0, Math.min(maxImportant, cellScores.length));
            
            return topCells.map(cell => ({ 
                row: cell.row, 
                col: cell.col, 
                reason: cell.reason 
            }));
        }
        
        // è®¡ç®—å•å…ƒæ ¼æ•°æ®çš„é‡è¦æ€§å¾—åˆ†
        function calculateImportanceScore(cellData, columnIndex, columnHeader, content) {
            const data = String(cellData).toLowerCase();
            const header = String(columnHeader).toLowerCase();
            let score = 0;
            let reasons = [];
            
            // æ•°å€¼ç±»æ•°æ®åŸºç¡€åˆ†
            if (/\d/.test(data)) {
                score += 1;
            }
            
            // å…³é”®æŒ‡æ ‡åŠ åˆ†
            if (header.includes('äººå£') || header.includes('é”€å”®') || header.includes('å¢é•¿') || 
                header.includes('ä¸šç»©') || header.includes('æ”¶å…¥') || header.includes('åˆ©æ¶¦')) {
                score += 3;
                reasons.push('æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡');
            }
            
            // ç™¾åˆ†æ¯”ã€è´§å¸ã€ç‰¹æ®Šå•ä½åŠ åˆ†
            if (data.includes('%')) {
                score += 2;
                reasons.push('ç™¾åˆ†æ¯”æ•°æ®');
            }
            if (data.includes('ä¸‡') || data.includes('äº¿') || data.includes('$') || data.includes('ï¿¥')) {
                score += 2;
                reasons.push('é‡è¦é‡‘é¢');
            }
            if (data.includes('+') || data.includes('-')) {
                score += 2;
                reasons.push('å˜åŒ–è¶‹åŠ¿');
            }
            
            // æå€¼æ•°æ®åŠ åˆ†ï¼ˆæœ€å¤§ã€æœ€å°å€¼ï¼‰
            const numericValue = parseFloat(data.replace(/[^\d.-]/g, ''));
            if (!isNaN(numericValue)) {
                const columnValues = content.rows.map(row => {
                    const val = parseFloat(String(row[columnIndex]).replace(/[^\d.-]/g, ''));
                    return isNaN(val) ? 0 : val;
                });
                const maxVal = Math.max(...columnValues);
                const minVal = Math.min(...columnValues);
                
                if (numericValue === maxVal && maxVal > minVal) {
                    score += 4;
                    reasons.push('è¯¥åˆ—æœ€é«˜å€¼');
                } else if (numericValue === minVal && maxVal > minVal) {
                    score += 4;
                    reasons.push('è¯¥åˆ—æœ€ä½å€¼');
                }
            }
            
            // ç‰¹æ®Šæ ‡è¯†è¯åŠ åˆ†
            if (data.includes('ç¬¬ä¸€') || data.includes('æœ€')) {
                score += 3;
                reasons.push('æ’åæ ‡è¯†');
            }
            if (data.includes('é¢†å…ˆ') || data.includes('ä¼˜åŠ¿') || data.includes('çªå‡º')) {
                score += 3;
                reasons.push('ç«äº‰ä¼˜åŠ¿');
            }
            if (data.includes('ç‰¹è‰²') || data.includes('æ ¸å¿ƒ') || data.includes('é‡ç‚¹') || data.includes('å…³é”®')) {
                score += 3;
                reasons.push('æ ¸å¿ƒç‰¹å¾');
            }
            
            // å¹´ä»½ç­‰æ—¶é—´ä¿¡æ¯
            if (/20\d{2}/.test(data)) {
                score += 1;
                reasons.push('æ—¶é—´ä¿¡æ¯');
            }
            
            // ä¼˜åŠ¿åŠŸèƒ½ç‰¹å¾è¯†åˆ«
            if (data.includes('ä¸€å¥è¯') || data.includes('å¤šæ ¼å¼') || data.includes('å®Œæ•´å¥—ä»¶') || 
                data.includes('officeé›†æˆ') || data.includes('é€»è¾‘æ¡†æ¶') || data.includes('å“ç‰Œé£æ ¼')) {
                score += 3;
                reasons.push('ç‹¬ç‰¹åŠŸèƒ½');
            }
            
            // é«˜æ•°å€¼æ ‡è¯†
            if (numericValue > 90 && data.includes('%')) {
                score += 2;
                reasons.push('é«˜è¾¾æˆç‡');
            }
            
            // æ„å»ºè§£é‡Šæ–‡æœ¬
            let reason = '';
            if (reasons.length > 0 && score >= 3) {
                const reasonText = reasons.join('ã€');
                if (score >= 7) {
                    reason = `ğŸ”¥ å…³é”®æ•°æ®ï¼š${reasonText}`;
                } else if (score >= 5) {
                    reason = `â­ é‡è¦ä¿¡æ¯ï¼š${reasonText}`;
                } else {
                    reason = `ğŸ“Œ å€¼å¾—å…³æ³¨ï¼š${reasonText}`;
                }
            }
            
            return { score, reason };
        }
    </script>
</body>
</html>
